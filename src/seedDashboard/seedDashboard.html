<template>
  <div class="page animated-page au-animate seedDashboardContainer">
    <div show.to-view="!loading" class="seedDashboard">
      <div class="leftColumn">
        <div class="intro">
          <div class="title heading heading2">${seed.metadata.general.projectName}</div>
          <div class="countdown">
            <time-left seed.to-view="seed"></time-left>
          </div>
          <div class="description subtext">${seed.metadata.projectDetails.proposition}</div>
          <div class="timeLeft">
            <span if.to-view="seed.isLive && !seed.minimumReached">
              <div class="label">MAX TIME LEFT</div>
              <div class="timer">${seed.endsInMilliseconds | timespan:"seconds":false:true}</div>
            </span>
          </div>
        </div>
        <!--
          ================ 
          Section One
          ================ 
        -->
        <div if.to-view="!connected && !geoBlocked" class="secton section1">
          <div class="description">Check eligibility</div>
          <div class="help">
            <question-mark text="Check if your address is eligibile to participate in this Seed. You can learn more about the Prime Launch whitelist process here"></question-mark>
          </div>
          <div class="subdescription subtext">Connect your wallet to contribute and claim rewards.</div>
          <div class="doit"><button class="button1" click.delegate="connect()">CONNECT</button></div>
        </div>
        <!--
          ================ 
          Section Two
          ================ 
        -->
        <div if.to-view="connected && seed.userIsWhitelisted && !geoBlocked" class="secton section2">
          <div class="description">Contribute ${seed.fundingTokenInfo.symbol}</div>
          <div class="help">
            <question-mark text="Submit ${seed.fundingTokenInfo.symbol} tokens here to participate in the Seed. Please remember you are paying ${seed.fundingTokenInfo.symbol} and be aware of lock-ups if there is a vesting cliff"></question-mark>
          </div>
          <div class="form">
            <div class="input">
              <div class="fundingInput">
                <numeric-input disabled.to-view="!seed.contributingIsOpen" value.bind="fundingTokenToPay" placeholder="0.0"></numeric-input>
                <div if.to-view="seed.contributingIsOpen" class="maxButton">
                  <a href="#" click.delegate="handleMaxBuy()">MAX</a>
                </div>
              </div>
            </div>
            <div class="units1">
              <div class="container">
                <div class="token">${seed.fundingTokenInfo.symbol}</div>
                <div class="subsection subtext">Balance: <tokenbalance
                    token-address.to-view="seed.fundingTokenAddress">
                  </tokenbalance>
                </div>
                <div if.to-view="userCanPay && lockRequired" class="unlockButton">
                  <a href="#" click.delegate="unlockFundingTokens()">UNLOCK</a>
                </div>
              </div>
            </div>
            <div class="equals">=</div>
            <div class="output">
              <formatted-number
                value.to-view="seedTokenReward"
                average></formatted-number>
            </div>
            <div class="units2">
              <div class="container">
                <div class="token">${seed.seedTokenInfo.symbol}</div>
              </div>
            </div>
            <div class="vestedMessage subtext">Tokens will vest for ${seed.vestingDuration | secondsDays} days with a cliff of ${seed.vestingCliff | secondsDays} days</div>
          </div>
          <div class="doit"><button if.to-view="seed.contributingIsOpen" class="submitButton button1" click.delegate="buy()">SUBMIT</button></div>
        </div>
        <!--
          ================ 
          Section Three
          ================ 
        -->
        <div if.to-view="connected && seed.userIsWhitelisted && !geoBlocked" class="secton section3">
          <div class="description">Claim ${seed.seedTokenInfo.symbol}</div>
          <div class="help">
            <question-mark text="Some projects will lock the Seed tokens for an amount of time. The tokens in the Claimable box are already unlocked and can be claimed by you at any point. The tokens in the Pending box (right side) are locked and will gradually unlock depending on the vesting period set by the team hosting the Seed"></question-mark>
          </div>
          <div class="form">
            <div class="input">
              <div class="seedRequest">
                <numeric-input
                  disabled.to-view="!(seed.claimingIsOpen && seed.userCanClaim)"
                  value.bind="seedTokenToReceive"
                  placeholder="0.0"></numeric-input>
                <div class="maxButton" if.to-view="seed.claimingIsOpen && seed.userCanClaim">
                  <a href="#" click.delegate="handleMaxClaim()">MAX</a>
                </div>
              </div>
            </div>
            <div class="units1">
              <div class="container">
                <div class="token">${seed.seedTokenInfo.symbol}</div>
                <div class="subsection subtext">Claimable: <formatted-number
                    value.to-view="seed.userClaimableAmount | ethwei"
                    thousands-separated></formatted-number>
                </div>
              </div>
            </div>
            <div class="equals">&nbsp;</div>
            <div class="output">
              <formatted-number
                value.to-view="seed.userPendingAmount | ethwei"
                average></formatted-number>
            </div>
            <div class="units2">
              <div class="container">
                <div class="token">${seed.seedTokenInfo.symbol}</div>
                <div class="subsection subtext">Pending</div>
              </div>
            </div>
            <div
              if.to-view="seed.isLive && seed.claimingIsOpen"
              class="vestedMessage subtext">Claiming will open whenever the max is reached, or in ${seed.endsInMilliseconds | timespan:"seconds":true}${seed.minimumReached ? '' : ', if by then the target has been reached'}</div>
          </div>
          <div class="doit"><button if.to-view="seed.claimingIsOpen && seed.userCanClaim" class="submitButton button1" click.delegate="claim()">SUBMIT</button></div>
        </div>
        <!--
          ================ 
          Section Four
          ================ 
        -->
        <div if.to-view="connected && seed.userIsWhitelisted && !geoBlocked" class="secton section4">
          <div class="description">Retrieve Contributed ${seed.fundingTokenInfo.symbol}</div>
          <div class="help">
            <question-mark text="If a seed round does not reach its target, you will be able to come here and retrieve all the funding tokens that you have contributed"></question-mark>
          </div>
          <!-- <div class="vestedMessage subtext">Retrieve all of the ${seed.fundingTokenInfo.symbol} that you have contributed</div> -->
          <div class="doit"><button if.to-view="userCanRetrieve" class="submitButton button1" click.delegate="retrieve()">RETRIEVE</button>
          </div>
        </div>
        <div class="notWhitelisted" if.to-view="geoBlocked">
          Sorry, you are located in a country that is not able to participate.
        </div>
        <div class="notWhitelisted" if.to-view="connected && !seed.userIsWhitelisted && !geoBlocked">
          Sorry, this Seed has a whitelist and your account has not been whitelisted. So using this account, you will not be able to participate.
        </div>
      </div>
      <!--
          ================ 
          Right Column
          ================ 
        -->
      <div class="rightColumn">
        <div class="section topSection">
          <div class="tokenId">
            <div class="icon"><img src.to-view="seed.seedTokenInfo.icon"></img></div>
            <div class="name">${seed.seedTokenInfo.name}</div>
            <div class="symbol">(${seed.seedTokenInfo.symbol})</div>
          </div>
          <div ref="progressBar" class="progressBar">
            <div ref="bar" class="bar ${(fractionComplete >= 1) ? 'complete' : ''}">&nbsp;</div>
          </div>
          <div class="raised">
            <div class="amount">$<formatted-number
                value.to-view="amountRaised | ethwei"
                thousands-separated></formatted-number>
            </div>
            <div class="denomination">USD raised</div>
            <!-- <div if.to-view="fractionComplete < 1" class="perc"> -->
            <div class="perc">
              <formatted-number
                average
                value.to-view="fractionComplete * 100"
                mantissa="2"></formatted-number>% of Target
            </div>
            <!-- <div else class="perc filled">Filled</div> -->
          </div>
        </div>
        <div class="section middleSection">
          <div class="label targetLabel">FUNDING TARGET</div>
          <div class="value target">
            <formatted-number value.to-view="seed.target | ethwei" mantissa="2" average></formatted-number>
          </div>
          <div class="label maxLabel">MAX</div>
          <div class="value max">
            <formatted-number value.to-view="seed.cap | ethwei" mantissa="2" average></formatted-number>
          </div>
          <div class="label valuationLabel">VALUATION</div>
          <div class="value valuation">$ <formatted-number
              if.to-view="seed.valuation"
              value.to-view="seed.valuation"
              thousands-separated></formatted-number>
            <span else>N/A</span>
          </div>
          <div class="label tokensleftLabel">SEED TOKENS LEFT</div>
          <div class="value tokensleft">
            <formatted-number value.to-view="percentSeedTokensLeft" average></formatted-number>%
          </div>
          <div class="tokenpriceLabel">
            <token-pair token1.to-view="seed.seedTokenInfo.icon" token2.to-view="seed.fundingTokenInfo.icon"></token-pair>
          </div>
          <div class="value tokenprice">1 <div class="symbol">${seed.seedTokenInfo.symbol}</div> = ${seed.fundingTokensPerSeedToken} <div class="symbol">${seed.fundingTokenInfo.symbol}</div>
          </div>
        </div>
        <div class="section bottomSection">
          <div class="title  heading heading3">About ${seed.metadata.general.projectName}</div>
          <div class="body subtext">${seed.metadata.projectDetails.summary}</div>
          <div if.to-view="seed.metadata.general.customLinks.length" class="links">
            <a href.to-view="seed.metadata.general.projectWebsite" target="_blank" rel="noopener noreferrer">
              <div class="icon ${iconClassForLinkType('home')}"></div>
              <div class="name">${seed.metadata.general.projectName}</div>
            </a>
            <a repeat.for="link of seed.metadata.general.customLinks" href.to-view="link.url" target="_blank" rel="noopener noreferrer">
              <div class="icon ${iconClassForLinkType(link.media)}"></div>
              <div class="name">${link.media}</div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
